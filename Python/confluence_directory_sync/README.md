# Confluence Directory Sync Tools

This repository contains two separate tools for working with Confluence pages:

1. **confluence_sync** - Synchronizes Markdown files from a local directory to Confluence pages
2. **delete_pages** - Deletes Confluence pages based on JSON lists generated by confluence_sync

## Project Structure

```
confluence_directory_sync/
├── confluence_sync/          # Main sync tool
│   ├── confluence_sync.py
│   ├── sync_to_confluence.bat
│   ├── test_confluence_sync.py
│   ├── run_tests.bat
│   ├── pytest.ini
│   ├── requirements.txt
│   ├── README.md
│   └── FUNCTIONAL_REQUIREMENTS.md
│
├── delete_pages/             # Delete pages utility
│   ├── delete_pages.py
│   ├── delete_pages.bat
│   ├── requirements.txt
│   └── DELETE_PAGES_REQUIREMENTS.md
│
└── README.md                 # This file
```

## Quick Start

### Confluence Sync Tool

See the [confluence_sync README](confluence_sync/README.md) for detailed documentation.

**Installation:**
```bash
cd confluence_sync
pip install -r requirements.txt
```

**Usage:**
```bash
python confluence_sync.py <directory_path> <confluence_page_id> \
    --url https://your-domain.atlassian.net \
    --username your-email@example.com \
    --api-token YOUR_API_TOKEN
```

### Delete Pages Tool

See the [delete_pages requirements](delete_pages/DELETE_PAGES_REQUIREMENTS.md) for detailed documentation.

**Installation:**
```bash
cd delete_pages
pip install -r requirements.txt
```

**Usage:**
```bash
python delete_pages.py created_pages_YYYYMMDD_HHMMSS.json \
    --url https://your-domain.atlassian.net \
    --username your-email@example.com \
    --api-token YOUR_API_TOKEN
```

## Requirements

- Python 3.7 or higher
- Confluence Cloud account with API access
- Confluence API token

## Getting a Confluence API Token

1. Log in to your Confluence instance
2. Go to your account settings
3. Navigate to Security → API tokens
4. Create a new API token
5. Copy the token (you'll need it for both tools)

## Tools Overview

### confluence_sync

Synchronizes Markdown files from a local directory structure to Confluence pages, maintaining the directory hierarchy. Features include:

- Recursive directory traversal
- Automatic page creation and updates
- Change detection (title, content, parent)
- Preview mode (dry-run)
- Rollback capability on errors
- Comprehensive logging

### delete_pages

A utility tool for deleting Confluence pages based on JSON files generated by `confluence_sync`. Features include:

- Safe deletion with confirmation prompts
- Dry-run mode for preview
- Detailed progress logging
- Error handling and recovery
- Batch file support for Windows

## License

This project is provided as-is for use according to your organization's policies.

